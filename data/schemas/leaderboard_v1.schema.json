{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://sagellm.sage.org.ai/schemas/leaderboard_v1.schema.json",
  "title": "sageLLM Leaderboard MVP Schema v1",
  "description": "MVP schema for leaderboard data used by sagellm-website",
  "oneOf": [
    {
      "$ref": "#/$defs/entry"
    },
    {
      "type": "array",
      "items": {
        "$ref": "#/$defs/entry"
      }
    }
  ],
  "$defs": {
    "versionOrNA": {
      "type": "string",
      "pattern": "^(\\d+\\.\\d+\\.\\d+(\\.\\d+)?|N/A)$"
    },
    "entry": {
      "type": "object",
      "required": [
        "entry_id",
        "sagellm_version",
        "config_type",
        "hardware",
        "model",
        "workload",
        "metrics",
        "versions",
        "environment",
        "metadata"
      ],
      "properties": {
        "entry_id": {
          "type": "string",
          "pattern": "^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$"
        },
        "sagellm_version": {
          "type": "string",
          "pattern": "^\\d+\\.\\d+\\.\\d+(\\.\\d+)?$"
        },
        "config_type": {
          "type": "string",
          "enum": ["single_gpu", "multi_gpu", "multi_node"]
        },
        "hardware": {
          "type": "object",
          "required": ["vendor", "chip_model", "chip_count"],
          "properties": {
            "vendor": {
              "type": "string",
              "enum": ["Intel", "AMD", "NVIDIA", "Huawei", "Unknown", "Other"]
            },
            "chip_model": {
              "type": "string"
            },
            "chip_count": {
              "type": "integer",
              "minimum": 1
            },
            "interconnect": {
              "type": "string"
            },
            "chips_per_node": {
              "type": ["integer", "null"],
              "minimum": 1
            },
            "intra_node_interconnect": {
              "type": ["string", "null"]
            },
            "memory_per_chip_gb": {
              "type": ["number", "null"],
              "minimum": 0
            },
            "total_memory_gb": {
              "type": ["number", "null"],
              "minimum": 0
            }
          },
          "anyOf": [
            { "required": ["interconnect"] },
            { "required": ["intra_node_interconnect"] }
          ],
          "additionalProperties": true
        },
        "model": {
          "type": "object",
          "required": ["name", "parameters", "precision"],
          "properties": {
            "name": { "type": "string" },
            "parameters": { "type": "string" },
            "precision": {
              "type": "string",
              "enum": ["FP32", "FP16", "BF16", "INT8", "INT4", "FP8"]
            },
            "quantization": { "type": ["string", "null"] }
          },
          "additionalProperties": true
        },
        "workload": {
          "type": "object",
          "required": ["input_length", "output_length"],
          "properties": {
            "input_length": { "type": "integer", "minimum": 1 },
            "output_length": { "type": "integer", "minimum": 1 },
            "batch_size": { "type": ["integer", "null"], "minimum": 1 },
            "concurrent_requests": { "type": ["integer", "null"], "minimum": 1 },
            "dataset": { "type": ["string", "null"] }
          },
          "additionalProperties": true
        },
        "metrics": {
          "type": "object",
          "required": ["ttft_ms", "throughput_tps", "peak_mem_mb", "error_rate"],
          "properties": {
            "ttft_ms": { "type": "number", "minimum": 0 },
            "tbt_ms": { "type": ["number", "null"], "minimum": 0 },
            "tpot_ms": { "type": ["number", "null"], "minimum": 0 },
            "throughput_tps": { "type": "number", "minimum": 0 },
            "peak_mem_mb": { "type": "integer", "minimum": 0 },
            "error_rate": { "type": "number", "minimum": 0, "maximum": 1 },
            "prefix_hit_rate": { "type": ["number", "null"], "minimum": 0, "maximum": 1 },
            "kv_used_tokens": { "type": ["integer", "null"], "minimum": 0 },
            "kv_used_bytes": { "type": ["integer", "null"], "minimum": 0 },
            "evict_count": { "type": ["integer", "null"], "minimum": 0 },
            "evict_ms": { "type": ["number", "null"], "minimum": 0 },
            "spec_accept_rate": { "type": ["number", "null"], "minimum": 0, "maximum": 1 }
          },
          "additionalProperties": true
        },
        "cluster": {
          "oneOf": [
            { "type": "null" },
            {
              "type": "object",
              "required": ["node_count", "comm_backend", "topology_type"],
              "properties": {
                "node_count": { "type": "integer", "minimum": 2 },
                "comm_backend": { "type": "string" },
                "inter_node_network": { "type": ["string", "null"] },
                "network_bandwidth_gbps": { "type": ["integer", "null"], "minimum": 0 },
                "topology_type": { "type": "string" },
                "parallelism": {
                  "type": ["object", "null"],
                  "properties": {
                    "tensor_parallel": { "type": ["integer", "null"], "minimum": 1 },
                    "pipeline_parallel": { "type": ["integer", "null"], "minimum": 1 },
                    "data_parallel": { "type": ["integer", "null"], "minimum": 1 }
                  },
                  "additionalProperties": true
                }
              },
              "additionalProperties": true
            }
          ]
        },
        "versions": {
          "type": "object",
          "required": ["protocol", "backend", "core"],
          "properties": {
            "protocol": { "$ref": "#/$defs/versionOrNA" },
            "backend": { "$ref": "#/$defs/versionOrNA" },
            "core": { "$ref": "#/$defs/versionOrNA" },
            "control_plane": { "$ref": "#/$defs/versionOrNA" },
            "gateway": { "$ref": "#/$defs/versionOrNA" },
            "kv_cache": { "$ref": "#/$defs/versionOrNA" },
            "comm": { "$ref": "#/$defs/versionOrNA" },
            "compression": { "$ref": "#/$defs/versionOrNA" },
            "benchmark": { "$ref": "#/$defs/versionOrNA" }
          },
          "additionalProperties": true
        },
        "environment": {
          "type": "object",
          "required": ["os", "python_version"],
          "properties": {
            "os": { "type": "string" },
            "python_version": { "type": "string" },
            "pytorch_version": { "type": ["string", "null"] },
            "cuda_version": { "type": ["string", "null"] },
            "cann_version": { "type": ["string", "null"] },
            "driver_version": { "type": ["string", "null"] }
          },
          "additionalProperties": true
        },
        "kv_cache_config": {
          "type": ["object", "null"],
          "properties": {
            "enabled": { "type": "boolean" },
            "eviction_policy": { "type": ["string", "null"] },
            "budget_tokens": { "type": ["integer", "null"], "minimum": 0 },
            "prefix_cache_enabled": { "type": ["boolean", "null"] }
          },
          "additionalProperties": true
        },
        "metadata": {
          "type": "object",
          "required": ["submitted_at", "submitter", "data_source"],
          "properties": {
            "submitted_at": { "type": "string", "format": "date-time" },
            "submitter": { "type": "string" },
            "data_source": { "type": "string" },
            "reproducible_cmd": { "type": ["string", "null"] },
            "git_commit": { "type": ["string", "null"] },
            "release_date": { "type": ["string", "null"], "format": "date" },
            "changelog_url": { "type": ["string", "null"] },
            "notes": { "type": ["string", "null"] },
            "verified": { "type": ["boolean", "null"] }
          },
          "additionalProperties": true
        }
      },
      "additionalProperties": true
    }
  }
}
